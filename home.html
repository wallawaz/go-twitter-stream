<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>TrumpDooDoo</title>
  <link href="https://fonts.googleapis.com/css?family=Libre+Baskerville" rel="stylesheet">
  <link href="/css/style.css" rel="stylesheet">
  <link href="/css/odometer-default.css" rel="stylesheet">
</head>
<body>
<!--<h1>POTUS</h1>-->
<div class="main-container">
  <div class="left-container">
      <div class="half-container">
          <br />
          <br />
          <img src="https://media.giphy.com/media/3oz8xrAQweeLfVIkzC/giphy.gif"></img>
          <br />
          <span>Please click the Poo below</span>
          <span>in agreement</span><br />
          <span>that Donald Trump is a doo doo person.</span><br />
          <br />
          <button id="firePoo">ðŸ’©</button>
      </div>
      <div class="half-container">
        <br />
        <br />
        <br />
         <div class="odometer" id="mainCounter">0</div>
      </div>
  </div>
  <div class="right-container">
      <div class="full-container">
         <br />
         <br />
         <br />
         <br />
         <br />
         <br />
         <br />
         <div class="search">
             <input type="text" id="searchBox">
             <i class="fa fa-twitter fa-lg" aria-hidden="true"></i>
             <span>Search</span>
         </div>

         <table id="mainTable">
              <thead>
              <th class="ID"></th>
              <th class="CreatedAt"></th>
              <th class="Img"></th>
              <th class="User"></th>
              <th class="Text"></th>
            </thead>
            <tbody>
            </tbody>
          </table>
      </div>
  </div>
</div>


<script type="text/javascript" src="https://cdn.datatables.net/v/dt/jq-2.2.4/dt-1.10.15/datatables.min.js"></script>
<script src="https://use.fontawesome.com/e6d63fb807.js"></script>
<script type="text/javascript" src="/js/odometer.min.js"></script>
<!--
<script type="text/javascript">
  console.log("HERE");
  setTimeout(function() {

    let counter = document.querySelector('#mainCounter');
    counter.innerHTML = 1000;
  }, 1000);
</script>-->

<script type="text/javascript" src="/js/scripts.js"></script>
<script type="text/javascript">

let conn;
const NUMROWS = 10;
let TWEETCOUNTER = 0;

const main = document.querySelector(".main-container");
const mainCounter = document.querySelector(".odometer");

window.onload = function() {
    const dt = $("#mainTable").DataTable({
        "paging": false,
        "scrollY": 300,
        "bInfo" : false,
        "columnDefs": [
          {"visible": false, "targets": 0 },
          {"visible": false, "targets": 1 }
          ]
    });
    $("#searchBox").on("keyup search input paste cut", function() {
        dt.search(this.value).draw();
    });

    if (window["WebSocket"]) {
          conn = new WebSocket("ws://"+ document.location.host + "/ws");
          conn.onclose = function(evt) {
              let item = document.createElement("div");
              item.innerHTML = "<b>Connection closed</b>";
              main.appendChild(item);
          };
          conn.onmessage = function(evt) {

              //tweet or vote update?
              recv = JSON.parse(evt.data);
              console.log(recv);
              if ("POO" in recv) {
                  updateVotes(recv);
              } else {
                  updateTweets(recv);
              }
          };
          $("#firePoo").click(function() {
              //console.log(1);
              conn.send(1);
          });

      } else {
          let item = document.createElement("div");
          item.innerHTML = "<b>Your browser does not support WebSockets</b>";
          main.appendChild(item);
      }
}

</script>
</body>
</html>
