<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>TrumpDooDoo</title>
  <link href="https://fonts.googleapis.com/css?family=Libre+Baskerville" rel="stylesheet">
  <link href="/css/style.css" rel="stylesheet">
</head>
<body>
<h1>POTUS</h1>
<div id="main">
  <div class="split">
      <div class="box">
            <span id="counter">0</span>
      </div>
      <div>
          <button id="firePoo">ðŸ’©</button>
          <br />
          <br />
          <img src="https://media.giphy.com/media/3oz8xrAQweeLfVIkzC/giphy.gif"></img>
      </div>
  </div>
  <div class="split">
      <table id="mainTable">
          <thead>
          <th class="ID"></th>
          <th class="CreatedAt"></th>
          <th class="Img"></th>
          <th class="User"></th>
          <th class="Text"></th>
        </thead>
        <tbody>
        </tbody>
      </table>
  </div>
</div>


<script type="text/javascript" src="https://cdn.datatables.net/v/dt/jq-2.2.4/dt-1.10.15/datatables.min.js"></script>
<script type="text/javascript" src="/js/scripts.js"></script>
<script type="text/javascript">

  const NUMROWS = 10;
  let conn;
  let TWEETCOUNTER = 0;
  const main = document.querySelector("#main");
  const imageURLs = [
        "https://media.giphy.com/media/GrrjFZpBkKVhe/giphy.gif",
        "https://media.giphy.com/media/12zaaelwao65KU/giphy.gif"
        //"https://images-na.ssl-images-amazon.com/images/I/31eN8Ro0TML.jpg"
  ];
  const POOIMAGE = "https://media.giphy.com/media/3oz8xrAQweeLfVIkzC/giphy.gif";
  const TRUMPIMAGE = "https://media.giphy.com/media/l0HlCqyxYycGHyIRq/giphy.gif";

window.onload = function() {
    const dt = $("#mainTable").DataTable({
        "paging": false,
        "scrollY": 300,
        "bInfo" : false,
        "columnDefs": [
          {"visible": false, "targets": 0 },
          {"visible": false, "targets": 1 }
          ]
    });
      if (window["WebSocket"]) {
          conn = new WebSocket("ws://"+ document.location.host + "/ws");
          conn.onclose = function(evt) {
              let item = document.createElement("div");
              item.innerHTML = "<b>Connection closed</b>";
              main.appendChild(item);
          };
          conn.onmessage = function(evt) {

              //tweet or vote update?
              recv = JSON.parse(evt.data);
              console.log(recv);
              if ("POO" in recv) {
                  updateVotes(recv);
              } else {
                  updateTweets(recv);
              }
          };
          $("#firePoo").click(function() {
              console.log(1);
              conn.send(1);
          });

      } else {
          let item = document.createElement("div");
          item.innerHTML = "<b>Your browser does not support WebSockets</b>";
          main.appendChild(item);
      }
}

</script>
</body>
</html>
